
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Pauli Spin Blockade &#8212; HRL Reference Materials</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'charge-stability/8-spaghetti/spaghetti';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mathjs@12.3.2/lib/browser/math.min.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Roadmap" href="../roadmap.html" />
    <link rel="prev" title="Paper Summaries" href="../7-paper-summary/papersummary.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/hrl-logo.png" class="logo__image only-light" alt="HRL Reference Materials - Home"/>
    <script>document.write(`<img src="../../_static/hrl-logo.png" class="logo__image only-dark" alt="HRL Reference Materials - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Table of Contents
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../cover.html">Quantum Dot Measurement and Stability</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../1-load-unload/loading-and-unloading-single-dot.html">Loading and Unloading a Single Quantum Dot</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../1-load-unload/tunneling.html">Electron Tunneling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../2-sensing-dot/sensing-dot.html">Measuring Charge in Quantum Dots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3-double-dot/double-dot.html">Double Quantum Dots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4-qd-arrays/quantum-dot-arrays.html">Charge Sensing in Quantum Dot Arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="../5-quiz/subtopicquiz.html">Subtopic Quiz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../6-gloss/gloss.html">Glossary and Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../7-paper-summary/papersummary.html">Paper Summaries</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Pauli Spin Blockade</a></li>
<li class="toctree-l2"><a class="reference internal" href="../roadmap.html">Roadmap</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../documentation/intro.html">Documentation/Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../documentation/getting_started.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation/animations_tutorial.html">Animations Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation/quizzes.html">Quizzes in Jupyter Book</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation/sliders_tutorial.html">Sliders/Interactive Elements Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation/wall_of_truth.html">“Wall of Truth” Template</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation/github.html">Github Documentation</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../documentation/setup/intro.html">Setup Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/setup/jupyterbook/intro.html">Jupyter Book Setup</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../documentation/setup/jupyterhub/intro.html">Jupyter Hub Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/setup/gitlab/intro.html">Gitlab Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/setup/website/intro.html">Website Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation/video-embeds.html">Video Embed</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://strong-honeybee-virtually.ngrok-free.app/hub/user-redirect/git-pull?repo=https%3A//github.com/trishanamruthur/HRL-Labs-Clinic&urlpath=lab/tree/HRL-Labs-Clinic/HRL_book/charge-stability/8-spaghetti/spaghetti.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/trishanamruthur/HRL-Labs-Clinic" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/trishanamruthur/HRL-Labs-Clinic/edit/main/HRL_book/charge-stability/8-spaghetti/spaghetti.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/charge-stability/8-spaghetti/spaghetti.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Pauli Spin Blockade</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#intro-to-spaghetti-diagrams">Intro to Spaghetti Diagrams</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-new-spin-on-things">A New Spin on Things</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="pauli-spin-blockade">
<h1>Pauli Spin Blockade<a class="headerlink" href="#pauli-spin-blockade" title="Link to this heading">#</a></h1>
<p>Blah blah intro text.</p>
<section id="intro-to-spaghetti-diagrams">
<h2>Intro to Spaghetti Diagrams<a class="headerlink" href="#intro-to-spaghetti-diagrams" title="Link to this heading">#</a></h2>
<p>Recall the <a class="reference internal" href="../3-double-dot/double-dot.html#sec-stability-diagrams"><span class="std std-ref">stability diagrams</span></a> of double-dots from earlier. Suppose we want to examine the cases where there are exactly two electrons in the double-dot. In particular, we could examine a diagonal slice of the stablility diagram that passes through the (2,0), (1,1), and (0,2) regions. Movement along this line can be characterized in terms of the <strong>bias</strong> <span class="math notranslate nohighlight">\(\epsilon=\mu_2-\mu_1\)</span>—the difference in potentials of the two dots. Clearly, when the bias is high, the (2,0) state is more likely; when the bias is very negative, the (0,2) state is most favorable, and when the bias is small in magnitude the (1,1) state is most common. But we’d like to be more quantitative than that. We can create a simple model for this system, and then build on it later.</p>
<p>We will assume the tunnel coupling between the dots is a constant <span class="math notranslate nohighlight">\(t_c\)</span>, and that having two electrons in the same dot increases the energy of the system by a constant <span class="math notranslate nohighlight">\(U\)</span> due to Coulomb repulsion. The energies of the (2,0), (1,1), and (0,2) states are thus <span class="math notranslate nohighlight">\(2\mu_1+U\)</span>, <span class="math notranslate nohighlight">\(\mu_1+\mu_2\)</span>, and <span class="math notranslate nohighlight">\(2\mu_2+U\)</span> respectively. To simplify the math, let us instead set <span class="math notranslate nohighlight">\(\frac{1}{2}(\mu_1+\mu_2)\)</span> as our new 0 for energy, so that <span class="math notranslate nohighlight">\(\mu_1\)</span> becomes <span class="math notranslate nohighlight">\(-\frac{\epsilon}{2}\)</span> and <span class="math notranslate nohighlight">\(\mu_2\)</span> becomes <span class="math notranslate nohighlight">\(\frac{\epsilon}{2}\)</span>. Then the energies can be expressed as <span class="math notranslate nohighlight">\(U-\epsilon\)</span>, 0, and <span class="math notranslate nohighlight">\(U+\epsilon\)</span>. To construct a Hamiltonian, all we need are chances of moving from state to state. From the (1,1) state, you can move to either of the other states with chance <span class="math notranslate nohighlight">\(t_c\)</span>—one electron tunnels to the other dot to join its counterpart. From the (2,0) state, one electron can tunnel to the other dot to form the (1,1) state with chance <span class="math notranslate nohighlight">\(t_c\)</span>. However, it’s also possible for the <em>other</em> electron to do so instead. In any case, there is no way to move immediately to the (0,2) case. Putting this all together, we get <span class="math notranslate nohighlight">\(\begin{equation}\hat H=\begin{pmatrix}U-\epsilon&amp;2t_c&amp;0\\t_c&amp;0&amp;t_c\\0&amp;2t_c&amp;U+\epsilon\end{pmatrix}.\end{equation}\)</span></p>
<p>Solving for the eigenvalues is technically analytically possible, but not particularly illuminating. Instead let’s see a graph of them for various values of <span class="math notranslate nohighlight">\(\epsilon\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">bokeh.layouts</span> <span class="kn">import</span> <span class="n">column</span><span class="p">,</span> <span class="n">row</span>
<span class="kn">from</span> <span class="nn">bokeh.models</span> <span class="kn">import</span> <span class="n">ColumnDataSource</span><span class="p">,</span> <span class="n">CustomJS</span><span class="p">,</span> <span class="n">Slider</span><span class="p">,</span> <span class="n">MultiLine</span>
<span class="kn">from</span> <span class="nn">bokeh.plotting</span> <span class="kn">import</span> <span class="n">figure</span><span class="p">,</span> <span class="n">show</span><span class="p">,</span> <span class="n">save</span><span class="p">,</span> <span class="n">output_file</span>
<span class="kn">from</span> <span class="nn">bokeh.io</span> <span class="kn">import</span> <span class="n">output_file</span>
<span class="kn">from</span> <span class="nn">bokeh.resources</span> <span class="kn">import</span> <span class="n">CDN</span>
<span class="kn">from</span> <span class="nn">bokeh.embed</span> <span class="kn">import</span> <span class="n">file_html</span>
<span class="kn">import</span> <span class="nn">IPython</span>
<span class="n">UMAX</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">tc</span> <span class="o">=</span> <span class="mf">.3</span>
<span class="n">YMIN</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="n">YMAX</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">NUM</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">biases</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">UMAX</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">UMAX</span><span class="p">,</span> <span class="n">NUM</span><span class="p">)</span>
<span class="n">lambda1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NUM</span><span class="p">)</span>
<span class="n">lambda2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NUM</span><span class="p">)</span>
<span class="n">lambda3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NUM</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">determinant</span><span class="p">(</span><span class="n">epsilon</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="n">UMAX</span><span class="p">,</span> <span class="n">tc</span><span class="o">=</span><span class="n">tc</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate determinant of H - lambda I for given bias epsilon.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">U</span><span class="p">,</span> <span class="n">U</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">epsilon</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">tc</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">U</span> <span class="o">*</span> <span class="n">tc</span><span class="o">**</span><span class="mi">2</span><span class="p">]))</span>

<span class="n">roots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">NUM</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NUM</span><span class="p">):</span>
    <span class="n">roots</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">determinant</span><span class="p">(</span><span class="n">biases</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="c1"># there is only one crossing, of the (2,0)&amp;(0,2) states at \epsilon=0.</span>
<span class="c1"># it&#39;s probably out of graph range, but...</span>

<span class="nb">sorted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">roots</span><span class="p">)</span>
<span class="n">halfway</span> <span class="o">=</span> <span class="p">(</span><span class="n">NUM</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<span class="c1"># (2,0)</span>
<span class="n">lambda1</span><span class="p">[:</span><span class="n">halfway</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">[:</span><span class="n">halfway</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">lambda1</span><span class="p">[</span><span class="n">halfway</span><span class="p">:]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">[</span><span class="n">halfway</span><span class="p">:,</span><span class="mi">2</span><span class="p">]</span>
<span class="c1"># (1,1)</span>
<span class="n">lambda2</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># (0,2)</span>
<span class="n">lambda3</span><span class="p">[:</span><span class="n">halfway</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">[:</span><span class="n">halfway</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">lambda3</span><span class="p">[</span><span class="n">halfway</span><span class="p">:]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">[</span><span class="n">halfway</span><span class="p">:,</span><span class="mi">1</span><span class="p">]</span>

<span class="n">source</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">biases</span><span class="o">=</span><span class="n">biases</span><span class="p">,</span> <span class="n">lambda1</span><span class="o">=</span><span class="n">lambda1</span><span class="p">,</span> <span class="n">lambda2</span><span class="o">=</span><span class="n">lambda2</span><span class="p">,</span> <span class="n">lambda3</span><span class="o">=</span><span class="n">lambda3</span><span class="p">))</span>

<span class="n">plot</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">y_range</span><span class="o">=</span><span class="p">(</span><span class="n">YMIN</span><span class="p">,</span> <span class="n">YMAX</span><span class="p">),</span> <span class="n">x_range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">UMAX</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">UMAX</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
              <span class="n">x_axis_label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$$\text{bias }\epsilon\text{ (energy)}$$&quot;</span><span class="p">,</span>
              <span class="n">y_axis_label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$$E\text{ Energy}$$&quot;</span><span class="p">)</span>

<span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="s1">&#39;biases&#39;</span><span class="p">,</span> <span class="s1">&#39;lambda1&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">)</span>
<span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="s1">&#39;biases&#39;</span><span class="p">,</span> <span class="s1">&#39;lambda2&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">)</span>
<span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="s1">&#39;biases&#39;</span><span class="p">,</span> <span class="s1">&#39;lambda3&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">)</span>

<span class="n">U_slider</span> <span class="o">=</span> <span class="n">Slider</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mf">1.5</span> <span class="o">*</span> <span class="n">UMAX</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">UMAX</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$$U$$&quot;</span><span class="p">)</span>
<span class="n">tc_slider</span> <span class="o">=</span> <span class="n">Slider</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">tc</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">.01</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$$t_c$$&quot;</span><span class="p">)</span>

<span class="n">callback</span> <span class="o">=</span> <span class="n">CustomJS</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span> <span class="n">Uslider</span><span class="o">=</span><span class="n">U_slider</span><span class="p">,</span> <span class="n">tcslider</span><span class="o">=</span><span class="n">tc_slider</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">NUM</span><span class="p">),</span>
                    <span class="n">code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    const U = Uslider.value;</span>
<span class="s2">    const tc = tcslider.value;</span>
<span class="s2">    const NUM = num;</span>
<span class="s2">    const HALFWAY = Math.floor((NUM - 1) / 2) + 1;</span>

<span class="s2">    const biases = source.data.biases;</span>
<span class="s2">    const lambda1 = [];</span>
<span class="s2">    const lambda2 = [];</span>
<span class="s2">    const lambda3 = [];</span>

<span class="s2">    var roots = [];</span>
<span class="s2">    for (let i = 0; i &lt; biases.length; i++) {</span>
<span class="s2">        roots = math.polynomialRoot(2 * U * tc * tc, U * U - biases[i] * biases[i] - 2 * tc * tc, -2 * U, 1);</span>
<span class="s2">        roots.sort();</span>
<span class="s2">        lambda2.push(roots[0]);</span>
<span class="s2">        if (i &lt; HALFWAY) {</span>
<span class="s2">            lambda1.push(roots[1]);</span>
<span class="s2">            lambda3.push(roots[2]);</span>
<span class="s2">        } else {</span>
<span class="s2">            lambda3.push(roots[1]);</span>
<span class="s2">            lambda1.push(roots[2]);</span>
<span class="s2">        }</span>
<span class="s2">    }</span>

<span class="s2">    source.data = { biases, lambda1, lambda2, lambda3 }</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">U_slider</span><span class="o">.</span><span class="n">js_on_change</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
<span class="n">tc_slider</span><span class="o">.</span><span class="n">js_on_change</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>

<span class="n">html_repr</span> <span class="o">=</span> <span class="n">file_html</span><span class="p">(</span><span class="n">row</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="n">column</span><span class="p">(</span><span class="n">U_slider</span><span class="p">,</span> <span class="n">tc_slider</span><span class="p">)),</span> <span class="n">CDN</span><span class="p">)</span>
<span class="n">IPython</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">html_repr</span><span class="p">)</span>
<span class="c1"># debugging</span>
<span class="c1"># output_file(filename=&quot;/home/peter/tmp.html&quot;)</span>
<span class="c1"># save(plot)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Bokeh Application</title>
    <style>
      html, body {
        box-sizing: border-box;
        display: flow-root;
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-3.3.4.min.js"></script>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.3.4.min.js"></script>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-mathjax-3.3.4.min.js"></script>
    <script type="text/javascript">
        Bokeh.set_log_level("info");
    </script>
  </head>
  <body>
    <div id="a1ef49fe-2609-41ce-b532-5721c442439b" data-root-id="p1069" style="display: contents;"></div>
  
    <script type="application/json" id="p1074">
      {"11ff807e-2d59-4861-8386-679292ec57f6":{"version":"3.3.4","title":"Bokeh Application","roots":[{"type":"object","name":"Row","id":"p1069","attributes":{"children":[{"type":"object","name":"Figure","id":"p1004","attributes":{"width":400,"height":400,"x_range":{"type":"object","name":"Range1d","id":"p1013","attributes":{"start":-20,"end":20}},"y_range":{"type":"object","name":"Range1d","id":"p1014","attributes":{"start":-2,"end":4}},"x_scale":{"type":"object","name":"LinearScale","id":"p1015"},"y_scale":{"type":"object","name":"LinearScale","id":"p1016"},"title":{"type":"object","name":"Title","id":"p1011"},"renderers":[{"type":"object","name":"GlyphRenderer","id":"p1044","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p1001","attributes":{"selected":{"type":"object","name":"Selection","id":"p1002","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1003"},"data":{"type":"map","entries":[["biases",{"type":"ndarray","array":{"type":"bytes","data":"AAAAAAAANMBDYt7OkJgzwIbEvJ0hMTPAyiabbLLJMsANiXk7Q2IywFDrVwrU+jHAk0022WSTMcDXrxSo9SsxwBoS83aGxDDAXXTRRRddMMBArV8pUOsvwMdxHMdxHC/ATjbZZJNNLsDU+pUCtX4twFq/UqDWryzA4YMPPvjgK8BoSMzbGRIrwO4MiXk7QyrAdNFFF110KcD7lQK1fqUowIFav1Kg1ifACB988MEHJ8CO4ziO4zgmwBWo9SsFaiXAm2yyySabJMAiMW9nSMwjwKj1KwVq/SLAL7rooosuIsC1fqVArV8hwDxDYt7OkCDAhA8++OCDH8CSmLczJOYdwJ4hMW9nSBzAqqqqqqqqGsC4MyTm7QwZwMS8nSExbxfA0kUXXXTRFcDezpCYtzMUwOxXCtT6lRLA+OCDDz74EMAI1PqVArUOwCjm7QyJeQvAQPjggw8+CMBYCtT6lQIFwHAcx3EcxwHAIF100UUX/b9QgVq/UqD2v4ClQK1fKfC/YJNNNtlk478Ab2dIzNvJvwBvZ0jM28k/YJNNNtlk4z+ApUCtXynwP1CBWr9SoPY/EF100UUX/T9wHMdxHMcBQFgK1PqVAgVAQPjggw8+CEAg5u0MiXkLQAjU+pUCtQ5A+OCDDz74EEDsVwrU+pUSQNzOkJi3MxRA0EUXXXTRFUDEvJ0hMW8XQLgzJObtDBlArKqqqqqqGkCcITFvZ0gcQJCYtzMk5h1AhA8++OCDH0A8Q2LezpAgQLR+pUCtXyFALrrooosuIkCo9SsFav0iQCIxb2dIzCNAmmyyySabJEAUqPUrBWolQI7jOI7jOCZACB988MEHJ0CAWr9SoNYnQPyVArV+pShAdNFFF110KUDsDIl5O0MqQGhIzNsZEitA4IMPPvjgK0Bcv1Kg1q8sQNT6lQK1fi1ATDbZZJNNLkDIcRzHcRwvQECtXylQ6y9AXHTRRRddMEAaEvN2hsQwQNavFKj1KzFAlE022WSTMUBQ61cK1PoxQAyJeTtDYjJAyiabbLLJMkCGxLydITEzQERi3s6QmDNAAAAAAAAANEA="},"shape":[100],"dtype":"float64","order":"little"}],["lambda1",{"type":"ndarray","array":{"type":"bytes","data":"zZMYROmGiD+ZMhJ7jueJP0hJgqmbaYs/j9EJIMARjT/PKOSkkeWOPwUJsA7jdZA/bD4UrT+WkT+a+3MC2NiSP4pzvvbRQ5Q/GCzmf93elT8tsNoVt7OXP4Q/7kXhzpk/5HYGa7JAnD/SRlxI5h6fP6t8/U2CQ6E/cSD/tBVRoz98UUNlodWlP6IuoYnI/Kg/tH51uNQJrT9zbNME0DSxP/fi2zle67Q/H2ecoOJTuj98xPucKmHBPy0aTjdChMg/aT8aQIrA0j8deAg4KlHeP/ZD2H5Azuc/DCMs5yoz8T+FxHUezP/2P6S2tCopDf0/qAZ8ML+eAUAmgQAzJ8EEQMlBRBb96QdACIJheBgXC0DtDztFLEcOQLWL4G6yvBBABWtS6ppWEkBK88dCH/ETQIdLDiwdjBVAC5GBpnsnF0B6XzsMKMMYQOYUTikUXxpAw77e9TT7G0CcVuqzgZcdQLCXT0jzMx9Abv+f1kFoIEBSLh2lljYhQDTgG8X0BCJA13+ZYFXTIkA8EjGVh6EjQGQJ7ArYcCRAIGATfxk/JUB/b47lmA0mQLjWZfcl3CZAUlJO0bqqJ0DIVUF/VXkoQJLTtwH1RylAbDkes5gWKkDMCggZQOUqQN78/dHqsytAKqYAjZiCLEBMePYESVEtQFqd6f37Hy5Aaag1Q7HuLkC0iT2maL0vQIu0uv4QRjBAGOLRkW6tMEDag6T7zBQxQAGYES0sfDFAEUpjGIzjMUCxkSOx7EoyQIRZ9+tNsjJA8u9+vq8ZM0BdzzofEoEzQKkAdAV16DNAaoQnadhPNEBRSvRCPLc0QDhWC4ygHjVANcIhPgWGNUDEW2RTau01QGCkbMbPVDZA7gY3kjW8NkAOGhqymyM3QOjNviECizdAuGgZ3WjyN0DrOGPgz1k4QLTnFCg3wThAwFnhsJ4oOUB5DbF3BpA5QHnpnXlu9zlAd27vs9ZeOkBAQhckP8Y6QGAKrsenLTtAyY1wnBCVO0DRFj2gefw7QLoOEdHiYzxA7swGLUzLPEAElVOytTI9QDu/RV8fmj1AQAdDMokBPkA="},"shape":[100],"dtype":"float64","order":"little"}],["lambda2",{"type":"ndarray","array":{"type":"bytes","data":"nhTXHjQJJMAPQyqiuDojwJKKkctFbCLAVZwVytydIcCDVosGf88gwKWFATIuASDAPktvsdhlHsBwnbr2d8kcwH3HU2JALRvABaA9rTmRGcCOgI2dbfUXwCUkCsDoWRbAfm3wdbu+FMAc+5uG+yMTwJneKIbGiRHAUUKfP4vgD8CDfIuTZ68MwCpV97LQgAnAkQ2a5NNVBsB/vouzJDADwCK98YytEgDAy+klDJIF+r8k3FQULhb0v5DQXOyYCO2/Vqz9RFJb47+aogiVa27Yv9m+yJgRws+/dxLZeDZxxr/J41rvViXBv5Qh3c5Dv7u/be3Kcv5jt79GIKhxE1G0v3cUDG2eDLK/Q1kS3qBRsL8PBy3EDu2tv2WMz63dwau/VPDdXrj+qb+I+JZNn4uovxMOnv2aV6e/kbNuQWBWpr/Clawb2H6lv8ZEFa8tyqS/5cSYDS4zpL9o4v6s27WjvxKjIWkjT6O/jsVR7qf8or/oCAWDnLyiv/mrT6qqjaK/lOvfrN9uor88nBsdoF+ivzycGx2gX6K/lOvfrN9uor/5q0+qqo2iv+gIBYOcvKK/jcVR7qf8or8SoyFpI0+jv2ji/qzbtaO/5cSYDS4zpL/FRBWvLcqkv8KVrBvYfqW/kbNuQWBWpr8TDp79mlenv4n4lk2fi6i/UPDdXrj+qb9ljM+t3cGrvw8HLcQO7a2/RVkS3qBRsL91FAxtngyyv0QgqHETUbS/be3Kcv5jt7+UId3OQ7+7v8XjWu9WJcG/bBLZeDZxxr/ZvsiYEcLPv5qiCJVrbti/Taz9RFJb47980FzsmAjtvyTcVBQuFvS/y+klDJIF+r8gvfGMrRIAwIG+i7MkMAPAkQ2a5NNVBsAdVfey0IAJwIN8i5NnrwzATEKfP4vgD8Cd3iiGxokRwBz7m4b7IxPAeG3wdbu+FMAnJArA6FkWwI6AjZ1t9RfAAaA9rTmRGcB9x1NiQC0bwGyduvZ3yRzARktvsdhlHsClhQEyLgEgwIJWiwZ/zyDAVZwVytydIcCSipHLRWwiwBBDKqK4OiPAnhTXHjQJJMA="},"shape":[100],"dtype":"float64","order":"little"}],["lambda3",{"type":"ndarray","array":{"type":"bytes","data":"QAdDMokBPkA4v0VfH5o9QASVU7K1Mj1A7swGLUzLPEC5DhHR4mM8QNEWPaB5/DtAwo1wnBCVO0BfCq7Hpy07QEBCFyQ/xjpAcm7vs9ZeOkB56Z15bvc5QHkNsXcGkDlAvlnhsJ4oOUC05xQoN8E4QOo4Y+DPWThAuWgZ3WjyN0Dozb4hAos3QBAaGrKbIzdA7gY3kjW8NkBgpGzGz1Q2QMRbZFNq7TVANcIhPgWGNUA4VguMoB41QFJK9EI8tzRAaoQnadhPNECpAHQFdegzQF3POh8SgTNA+O9+vq8ZM0CCWffrTbIyQLGRI7HsSjJAEUpjGIzjMUABmBEtLHwxQNmDpPvMFDFAGOLRkW6tMECLtLr+EEYwQLSJPaZovS9Aaqg1Q7HuLkBWnen9+x8uQEx49gRJUS1AKqYAjZiCLEDe/P3R6rMrQNIKCBlA5SpAbDkes5gWKkCS07cB9UcpQMhVQX9VeShAU1JO0bqqJ0C41mX3JdwmQH9vjuWYDSZAIGATfxk/JUBkCewK2HAkQDwSMZWHoSNA13+ZYFXTIkA04BvF9AQiQFIuHaWWNiFAcP+f1kFoIECwl09I8zMfQJxW6rOBlx1Aw77e9TT7G0DpFE4pFF8aQHpfOwwowxhAC5GBpnsnF0CHSw4sHYwVQE3zx0If8RNAB2tS6ppWEkC1i+BusrwQQO0PO0UsRw5AAIJheBgXC0DKQUQW/ekHQCSBADMnwQRAqAZ8ML+eAUCktrQqKQ39P4bEdR7M//Y/DiMs5yoz8T/2Q9h+QM7nPx14CDgqUd4/dT8aQIrA0j86Gk43QoTIP3zE+5wqYcE/H2ecoOJTuj/64ts5Xuu0P29s0wTQNLE/tH51uNQJrT+qLqGJyPyoP3xRQ2Wh1aU/cyD/tBVRoz+ofP1NgkOhP9JGXEjmHp8/7XYGa7JAnD+AP+5F4c6ZPy2w2hW3s5c/HCzmf93elT+Kc7720UOUP537cwLY2JI/aD4UrT+WkT8FCbAO43WQP88o5KSR5Y4/j9EJIMARjT9ISYKpm2mLP5cyEnuO54k/zZMYROmGiD8="},"shape":[100],"dtype":"float64","order":"little"}]]}}},"view":{"type":"object","name":"CDSView","id":"p1045","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1046"}}},"glyph":{"type":"object","name":"Line","id":"p1041","attributes":{"x":{"type":"field","field":"biases"},"y":{"type":"field","field":"lambda1"},"line_color":"#1f77b4"}},"nonselection_glyph":{"type":"object","name":"Line","id":"p1042","attributes":{"x":{"type":"field","field":"biases"},"y":{"type":"field","field":"lambda1"},"line_color":"#1f77b4","line_alpha":0.1}},"muted_glyph":{"type":"object","name":"Line","id":"p1043","attributes":{"x":{"type":"field","field":"biases"},"y":{"type":"field","field":"lambda1"},"line_color":"#1f77b4","line_alpha":0.2}}}},{"type":"object","name":"GlyphRenderer","id":"p1053","attributes":{"data_source":{"id":"p1001"},"view":{"type":"object","name":"CDSView","id":"p1054","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1055"}}},"glyph":{"type":"object","name":"Line","id":"p1050","attributes":{"x":{"type":"field","field":"biases"},"y":{"type":"field","field":"lambda2"},"line_color":"#1f77b4"}},"nonselection_glyph":{"type":"object","name":"Line","id":"p1051","attributes":{"x":{"type":"field","field":"biases"},"y":{"type":"field","field":"lambda2"},"line_color":"#1f77b4","line_alpha":0.1}},"muted_glyph":{"type":"object","name":"Line","id":"p1052","attributes":{"x":{"type":"field","field":"biases"},"y":{"type":"field","field":"lambda2"},"line_color":"#1f77b4","line_alpha":0.2}}}},{"type":"object","name":"GlyphRenderer","id":"p1062","attributes":{"data_source":{"id":"p1001"},"view":{"type":"object","name":"CDSView","id":"p1063","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1064"}}},"glyph":{"type":"object","name":"Line","id":"p1059","attributes":{"x":{"type":"field","field":"biases"},"y":{"type":"field","field":"lambda3"},"line_color":"#1f77b4"}},"nonselection_glyph":{"type":"object","name":"Line","id":"p1060","attributes":{"x":{"type":"field","field":"biases"},"y":{"type":"field","field":"lambda3"},"line_color":"#1f77b4","line_alpha":0.1}},"muted_glyph":{"type":"object","name":"Line","id":"p1061","attributes":{"x":{"type":"field","field":"biases"},"y":{"type":"field","field":"lambda3"},"line_color":"#1f77b4","line_alpha":0.2}}}}],"toolbar":{"type":"object","name":"Toolbar","id":"p1012","attributes":{"tools":[{"type":"object","name":"PanTool","id":"p1027"},{"type":"object","name":"WheelZoomTool","id":"p1028","attributes":{"renderers":"auto"}},{"type":"object","name":"BoxZoomTool","id":"p1029","attributes":{"overlay":{"type":"object","name":"BoxAnnotation","id":"p1030","attributes":{"syncable":false,"level":"overlay","visible":false,"left":{"type":"number","value":"nan"},"right":{"type":"number","value":"nan"},"top":{"type":"number","value":"nan"},"bottom":{"type":"number","value":"nan"},"left_units":"canvas","right_units":"canvas","top_units":"canvas","bottom_units":"canvas","line_color":"black","line_alpha":1.0,"line_width":2,"line_dash":[4,4],"fill_color":"lightgrey","fill_alpha":0.5}}}},{"type":"object","name":"SaveTool","id":"p1035"},{"type":"object","name":"ResetTool","id":"p1036"},{"type":"object","name":"HelpTool","id":"p1037"}]}},"left":[{"type":"object","name":"LinearAxis","id":"p1022","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p1023","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"BasicTickFormatter","id":"p1024"},"axis_label":"$$E\\text{ Energy}$$","major_label_policy":{"type":"object","name":"AllLabels","id":"p1025"}}}],"below":[{"type":"object","name":"LinearAxis","id":"p1017","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p1018","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"BasicTickFormatter","id":"p1019"},"axis_label":"$$\\text{bias }\\epsilon\\text{ (energy)}$$","major_label_policy":{"type":"object","name":"AllLabels","id":"p1020"}}}],"center":[{"type":"object","name":"Grid","id":"p1021","attributes":{"axis":{"id":"p1017"}}},{"type":"object","name":"Grid","id":"p1026","attributes":{"dimension":1,"axis":{"id":"p1022"}}}]}},{"type":"object","name":"Column","id":"p1068","attributes":{"children":[{"type":"object","name":"Slider","id":"p1065","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"type":"object","name":"CustomJS","id":"p1067","attributes":{"args":{"type":"map","entries":[["source",{"id":"p1001"}],["Uslider",{"id":"p1065"}],["tcslider",{"type":"object","name":"Slider","id":"p1066","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"id":"p1067"}]]]},"title":"$$t_c$$","start":0.05,"end":0.5,"value":0.3,"step":0.01}}],["num",100]]},"code":"\n    const U = Uslider.value;\n    const tc = tcslider.value;\n    const NUM = num;\n    const HALFWAY = Math.floor((NUM - 1) / 2) + 1;\n\n    const biases = source.data.biases;\n    const lambda1 = [];\n    const lambda2 = [];\n    const lambda3 = [];\n\n    var roots = [];\n    for (let i = 0; i &lt; biases.length; i++) {\n        roots = math.polynomialRoot(2 * U * tc * tc, U * U - biases[i] * biases[i] - 2 * tc * tc, -2 * U, 1);\n        roots.sort();\n        lambda2.push(roots[0]);\n        if (i &lt; HALFWAY) {\n            lambda1.push(roots[1]);\n            lambda3.push(roots[2]);\n        } else {\n            lambda3.push(roots[1]);\n            lambda1.push(roots[2]);\n        }\n    }\n\n    source.data = { biases, lambda1, lambda2, lambda3 }\n"}}]]]},"title":"$$U$$","start":1,"end":15.0,"value":10,"step":0.05}},{"id":"p1066"}]}}]}}]}}
    </script>
    <script type="text/javascript">
      (function() {
        const fn = function() {
          Bokeh.safely(function() {
            (function(root) {
              function embed_document(root) {
              const docs_json = document.getElementById('p1074').textContent;
              const render_items = [{"docid":"11ff807e-2d59-4861-8386-679292ec57f6","roots":{"p1069":"a1ef49fe-2609-41ce-b532-5721c442439b"},"root_ids":["p1069"]}];
              root.Bokeh.embed.embed_items(docs_json, render_items);
              }
              if (root.Bokeh !== undefined) {
                embed_document(root);
              } else {
                let attempts = 0;
                const timer = setInterval(function(root) {
                  if (root.Bokeh !== undefined) {
                    clearInterval(timer);
                    embed_document(root);
                  } else {
                    attempts++;
                    if (attempts > 100) {
                      clearInterval(timer);
                      console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
                    }
                  }
                }, 10, root)
              }
            })(window);
          });
        };
        if (document.readyState != "loading") fn();
        else document.addEventListener("DOMContentLoaded", fn);
      })();
    </script>
  </body>
</html></div></div>
</div>
<p>This is a simple “spaghetti diagram,” and it (sort of) tells us some things about the dynamics of the system. At each of the anticrossings at <span class="math notranslate nohighlight">\(\epsilon=\pm U\)</span>, the mostly likely state changes from (0,2) to (1,1) or (1,1) to (2,0). In most spagetti diagrams, you’re going to see a whole lot of anticrossings (a.k.a. “avoided crossings”), so let’s go over them in more detail.</p>
<p>The energy of the ground state is graphed as the lowest curve, and, as the name “anticrossing” suggests, it never actually switches places with another eigenvalue. So where does the state change come from? Let’s look back at the Hamiltonian. Let’s assume <span class="math notranslate nohighlight">\(t_c\ll U\pm\epsilon\)</span>. Then the matrix is basically already diagonalized, and we can read the eigenvalues of the diagonal. When <span class="math notranslate nohighlight">\(|\epsilon|\ll U\)</span>, the ground state is at about 0 energy, and the eigenstate is basically (1,1). This is the middle portion of our graph. But when <span class="math notranslate nohighlight">\(|\epsilon|\gg U\)</span>, the ground state becomes <span class="math notranslate nohighlight">\(U\pm\epsilon\)</span>, and the eigenstate changes to either (2,0) or (0,2)! So, while the eigenvalues do not cross, the eigenstates do switch around, which is why the favored state changes.</p>
<p>We can also look at the case where <span class="math notranslate nohighlight">\(\epsilon=U\)</span>. Looking at the upper left 2x2 block of the Hamiltonian, <span class="math notranslate nohighlight">\(\begin{pmatrix}0&amp;2t_c\\t_c&amp;0\end{pmatrix}\)</span>, we can see two of the eigenvalues will be <span class="math notranslate nohighlight">\(\lambda=\pm\sqrt{2}t_c\)</span>, with corresponding eigenstates <span class="math notranslate nohighlight">\(\frac{1}{\sqrt{3}}\begin{pmatrix}\pm\sqrt{2}\\1\\0\end{pmatrix}\)</span>. So the system is in a pretty even mix of the (2,0) and (1,1) states. as <span class="math notranslate nohighlight">\(\epsilon\)</span> increases, eigenstate associated with the ground state approaches <span class="math notranslate nohighlight">\(\begin{pmatrix}1\\0\\0\end{pmatrix}\)</span>.</p>
</section>
<section id="a-new-spin-on-things">
<h2>A New Spin on Things<a class="headerlink" href="#a-new-spin-on-things" title="Link to this heading">#</a></h2>
<p>Up until now we have ignored electron spin, but of course the spin states of the electrons affect the energy of having two electrons in the same dot. The spin singlet state has energy <span class="math notranslate nohighlight">\(E_S=U\pm\epsilon\)</span>. We will assume there are no magnetic fields for the moment, so the three spin-triplets states are degenerate with energy <span class="math notranslate nohighlight">\(E_T=E_S+J\)</span>.</p>
<p>So, there are now six states our system can be in: still (2,0), (1,1), and (0,2), but now in each case the electrons can be in either singlet or triplet states. We will assume the electrons’ spin does not change over the timescales we care about. So, the Hamiltonian can simply be written as <span class="math notranslate nohighlight">\(\hat H=\left(\begin{array}{c|c}\hat H_S&amp;0\\\hline0&amp;\hat H_T\end{array}\right)\)</span>, where <span class="math notranslate nohighlight">\(\hat H_S\)</span> is the same as our Hamiltonian above and <span class="math notranslate nohighlight">\(\hat H_T=\begin{pmatrix}U+J-\epsilon&amp;2t_c&amp;0\\t_c&amp;0&amp;t_c\\0&amp;2t_c&amp;U+J+\epsilon\end{pmatrix}\)</span>. In other words, it looks exactly the same except with anticrossings at <span class="math notranslate nohighlight">\(\epsilon=\pm(U+J)\)</span>. The graph would thus look like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">bokeh.layouts</span> <span class="kn">import</span> <span class="n">column</span><span class="p">,</span> <span class="n">row</span>
<span class="kn">from</span> <span class="nn">bokeh.models</span> <span class="kn">import</span> <span class="n">ColumnDataSource</span><span class="p">,</span> <span class="n">CustomJS</span><span class="p">,</span> <span class="n">Slider</span><span class="p">,</span> <span class="n">MultiLine</span>
<span class="kn">from</span> <span class="nn">bokeh.plotting</span> <span class="kn">import</span> <span class="n">figure</span><span class="p">,</span> <span class="n">show</span><span class="p">,</span> <span class="n">save</span><span class="p">,</span> <span class="n">output_file</span>
<span class="kn">from</span> <span class="nn">bokeh.io</span> <span class="kn">import</span> <span class="n">output_file</span>
<span class="kn">from</span> <span class="nn">bokeh.resources</span> <span class="kn">import</span> <span class="n">CDN</span>
<span class="kn">from</span> <span class="nn">bokeh.embed</span> <span class="kn">import</span> <span class="n">file_html</span>
<span class="kn">import</span> <span class="nn">IPython</span>
<span class="n">UMAX</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">tc</span> <span class="o">=</span> <span class="mf">.3</span>
<span class="n">YMIN</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="n">YMAX</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">NUM</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">biases</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span> <span class="o">*</span> <span class="n">UMAX</span><span class="p">,</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="n">UMAX</span><span class="p">,</span> <span class="n">NUM</span><span class="p">)</span>
<span class="n">lambda1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NUM</span><span class="p">)</span>
<span class="n">lambda2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NUM</span><span class="p">)</span>
<span class="n">lambda3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NUM</span><span class="p">)</span>
<span class="n">triplet1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NUM</span><span class="p">)</span>
<span class="n">triplet2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NUM</span><span class="p">)</span>
<span class="n">triplet3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NUM</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">determinant</span><span class="p">(</span><span class="n">epsilon</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="n">UMAX</span><span class="p">,</span> <span class="n">tc</span><span class="o">=</span><span class="n">tc</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate determinant of H - lambda I for given bias epsilon.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">U</span><span class="p">,</span> <span class="n">U</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">epsilon</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">tc</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">U</span> <span class="o">*</span> <span class="n">tc</span><span class="o">**</span><span class="mi">2</span><span class="p">]))</span>

<span class="n">roots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">NUM</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NUM</span><span class="p">):</span>
    <span class="n">roots</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">determinant</span><span class="p">(</span><span class="n">biases</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="c1"># there is only one crossing, of the (2,0)&amp;(0,2) states at \epsilon=0.</span>
<span class="c1"># it&#39;s probably out of graph range, but...</span>

<span class="nb">sorted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">roots</span><span class="p">)</span>
<span class="n">halfway</span> <span class="o">=</span> <span class="p">(</span><span class="n">NUM</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<span class="c1"># (2,0)</span>
<span class="n">lambda1</span><span class="p">[:</span><span class="n">halfway</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">[:</span><span class="n">halfway</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">lambda1</span><span class="p">[</span><span class="n">halfway</span><span class="p">:]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">[</span><span class="n">halfway</span><span class="p">:,</span><span class="mi">2</span><span class="p">]</span>
<span class="c1"># (1,1)</span>
<span class="n">lambda2</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># (0,2)</span>
<span class="n">lambda3</span><span class="p">[:</span><span class="n">halfway</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">[:</span><span class="n">halfway</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">lambda3</span><span class="p">[</span><span class="n">halfway</span><span class="p">:]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">[</span><span class="n">halfway</span><span class="p">:,</span><span class="mi">1</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NUM</span><span class="p">):</span>
    <span class="n">roots</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">determinant</span><span class="p">(</span><span class="n">biases</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">U</span><span class="o">=</span><span class="n">UMAX</span><span class="o">*</span><span class="mf">1.5</span><span class="p">)</span>

<span class="nb">sorted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">roots</span><span class="p">)</span>
<span class="n">halfway</span> <span class="o">=</span> <span class="p">(</span><span class="n">NUM</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<span class="c1"># (2,0)</span>
<span class="n">triplet1</span><span class="p">[:</span><span class="n">halfway</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">[:</span><span class="n">halfway</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">triplet1</span><span class="p">[</span><span class="n">halfway</span><span class="p">:]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">[</span><span class="n">halfway</span><span class="p">:,</span><span class="mi">2</span><span class="p">]</span>
<span class="c1"># (1,1)</span>
<span class="n">triplet2</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># (0,2)</span>
<span class="n">triplet3</span><span class="p">[:</span><span class="n">halfway</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">[:</span><span class="n">halfway</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">triplet3</span><span class="p">[</span><span class="n">halfway</span><span class="p">:]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">[</span><span class="n">halfway</span><span class="p">:,</span><span class="mi">1</span><span class="p">]</span>

<span class="n">source</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">biases</span><span class="o">=</span><span class="n">biases</span><span class="p">,</span> <span class="n">lambda1</span><span class="o">=</span><span class="n">lambda1</span><span class="p">,</span> <span class="n">lambda2</span><span class="o">=</span><span class="n">lambda2</span><span class="p">,</span> <span class="n">lambda3</span><span class="o">=</span><span class="n">lambda3</span><span class="p">,</span>
                                    <span class="n">triplet1</span><span class="o">=</span><span class="n">triplet1</span><span class="p">,</span> <span class="n">triplet2</span><span class="o">=</span><span class="n">triplet2</span><span class="p">,</span> <span class="n">triplet3</span><span class="o">=</span><span class="n">triplet3</span><span class="p">))</span>

<span class="n">plot</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">y_range</span><span class="o">=</span><span class="p">(</span><span class="n">YMIN</span><span class="p">,</span> <span class="n">YMAX</span><span class="p">),</span> <span class="n">x_range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span> <span class="o">*</span> <span class="n">UMAX</span><span class="p">,</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="n">UMAX</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
              <span class="n">x_axis_label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$$\text{bias }\epsilon\text{ (energy)}$$&quot;</span><span class="p">,</span>
              <span class="n">y_axis_label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$$E\text{ (energy)}$$&quot;</span><span class="p">)</span>

<span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="s1">&#39;biases&#39;</span><span class="p">,</span> <span class="s1">&#39;lambda1&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">legend_label</span><span class="o">=</span><span class="s2">&quot;Singlet&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="s1">&#39;biases&#39;</span><span class="p">,</span> <span class="s1">&#39;lambda2&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="s1">&#39;biases&#39;</span><span class="p">,</span> <span class="s1">&#39;lambda3&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="s1">&#39;biases&#39;</span><span class="p">,</span> <span class="s1">&#39;triplet1&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">legend_label</span><span class="o">=</span><span class="s2">&quot;Triplet&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="s1">&#39;biases&#39;</span><span class="p">,</span> <span class="s1">&#39;triplet2&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="s1">&#39;biases&#39;</span><span class="p">,</span> <span class="s1">&#39;triplet3&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">U_slider</span> <span class="o">=</span> <span class="n">Slider</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mf">1.5</span> <span class="o">*</span> <span class="n">UMAX</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">UMAX</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$$U$$&quot;</span><span class="p">)</span>
<span class="n">tc_slider</span> <span class="o">=</span> <span class="n">Slider</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">tc</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">.01</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$$t_c$$&quot;</span><span class="p">)</span>

<span class="c1"># update if above code ever gets working</span>
<span class="n">callback</span> <span class="o">=</span> <span class="n">CustomJS</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span> <span class="n">Uslider</span><span class="o">=</span><span class="n">U_slider</span><span class="p">,</span> <span class="n">tcslider</span><span class="o">=</span><span class="n">tc_slider</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">NUM</span><span class="p">),</span>
                    <span class="n">code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    const U = Uslider.value;</span>
<span class="s2">    const tc = tcslider.value;</span>
<span class="s2">    const NUM = num;</span>
<span class="s2">    const HALFWAY = Math.floor((NUM - 1) / 2) + 1;</span>

<span class="s2">    const biases = source.data.biases;</span>
<span class="s2">    const lambda1 = [];</span>
<span class="s2">    const lambda2 = [];</span>
<span class="s2">    const lambda3 = [];</span>

<span class="s2">    var roots = [];</span>
<span class="s2">    for (let i = 0; i &lt; biases.length; i++) {</span>
<span class="s2">        roots = math.polynomialRoot(2 * U * tc * tc, U * U - biases[i] * biases[i] - 2 * tc * tc, -2 * U, 1);</span>
<span class="s2">        roots.sort();</span>
<span class="s2">        lambda2.push(roots[0]);</span>
<span class="s2">        if (i &lt; HALFWAY) {</span>
<span class="s2">            lambda1.push(roots[1]);</span>
<span class="s2">            lambda3.push(roots[2]);</span>
<span class="s2">        } else {</span>
<span class="s2">            lambda3.push(roots[1]);</span>
<span class="s2">            lambda1.push(roots[2]);</span>
<span class="s2">        }</span>
<span class="s2">    }</span>

<span class="s2">    source.data = { biases, lambda1, lambda2, lambda3 }</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">U_slider</span><span class="o">.</span><span class="n">js_on_change</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
<span class="n">tc_slider</span><span class="o">.</span><span class="n">js_on_change</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>

<span class="n">html_repr</span> <span class="o">=</span> <span class="n">file_html</span><span class="p">(</span><span class="n">row</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="n">column</span><span class="p">(</span><span class="n">U_slider</span><span class="p">,</span> <span class="n">tc_slider</span><span class="p">)),</span> <span class="n">CDN</span><span class="p">)</span>
<span class="n">IPython</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">html_repr</span><span class="p">)</span>
<span class="c1"># debugging</span>
<span class="c1"># output_file(filename=&quot;/home/peter/tmp.html&quot;)</span>
<span class="c1"># save(plot)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Bokeh Application</title>
    <style>
      html, body {
        box-sizing: border-box;
        display: flow-root;
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-3.3.4.min.js"></script>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.3.4.min.js"></script>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-mathjax-3.3.4.min.js"></script>
    <script type="text/javascript">
        Bokeh.set_log_level("info");
    </script>
  </head>
  <body>
    <div id="eb7783a3-531c-477b-a044-2a25681115ea" data-root-id="p1173" style="display: contents;"></div>
  
    <script type="application/json" id="p1181">
      {"a57632d7-533c-4e11-8a0b-43dd65afab54":{"version":"3.3.4","title":"Bokeh Application","roots":[{"type":"object","name":"Row","id":"p1173","attributes":{"children":[{"type":"object","name":"Figure","id":"p1078","attributes":{"width":400,"height":400,"x_range":{"type":"object","name":"Range1d","id":"p1087","attributes":{"start":-25.0,"end":25.0}},"y_range":{"type":"object","name":"Range1d","id":"p1088","attributes":{"start":-2,"end":4}},"x_scale":{"type":"object","name":"LinearScale","id":"p1089"},"y_scale":{"type":"object","name":"LinearScale","id":"p1090"},"title":{"type":"object","name":"Title","id":"p1085"},"renderers":[{"type":"object","name":"GlyphRenderer","id":"p1118","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p1075","attributes":{"selected":{"type":"object","name":"Selection","id":"p1076","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1077"},"data":{"type":"map","entries":[["biases",{"type":"ndarray","array":{"type":"bytes","data":"AAAAAAAAOcDU+pUCtX44wKj1KwVq/TfAfPDBBx98N8BQ61cK1Po2wCTm7QyJeTbA+OCDDz74NcDM2xkS83Y1wKDWrxSo9TTAdNFFF110NMBIzNsZEvMzwBzHcRzHcTPA8MEHH3zwMsDEvJ0hMW8ywJi3MyTm7THAbLLJJptsMcBArV8pUOswwBSo9SsFajDA0UUXXXTRL8B5O0Ni3s4uwCExb2dIzC3AySabbLLJLMBxHMdxHMcrwBkS83aGxCrAwgcffPDBKcBq/UqBWr8owBLzdobEvCfAuuiiiy66JsBi3s6QmLclwArU+pUCtSTAsskmm2yyI8Bav1Kg1q8iwAK1fqVArSHAqqqqqqqqIMCkQK1fKVAfwPQrBWr9Sh3ARBdddNFFG8CUArV+pUAZwOTtDIl5OxfANNlkk002FcCExLydITETwNSvFKj1KxHASDbZZJNNDsDoDIl5O0MKwIjjOI7jOAbAKLrooosuAsCQITFvZ0j8v9DOkJi3M/S/QPjggw8+6L+ApUCtXynQv4ClQK1fKdA/QPjggw8+6D/gzpCYtzP0P6AhMW9nSPw/MLrooosuAkCQ4ziO4zgGQPAMiXk7QwpAUDbZZJNNDkDYrxSo9SsRQIjEvJ0hMRNAONlkk002FUDo7QyJeTsXQJgCtX6lQBlASBdddNFFG0D4KwVq/UodQKhArV8pUB9ArKqqqqqqIEAEtX6lQK0hQFy/UqDWryJAtMkmm2yyI0AM1PqVArUkQGTezpCYtyVAvOiiiy66JkAU83aGxLwnQGz9SoFavyhAxAcffPDBKUAcEvN2hsQqQHQcx3EcxytAzCabbLLJLEAkMW9nSMwtQHw7Q2Lezi5A1EUXXXTRL0AWqPUrBWowQEKtXylQ6zBAbrLJJptsMUCatzMk5u0xQMa8nSExbzJA8sEHH3zwMkAex3Ecx3EzQErM2xkS8zNAdtFFF110NECi1q8UqPU0QM7bGRLzdjVA+uCDDz74NUAm5u0MiXk2QFLrVwrU+jZAfPDBBx98N0Co9SsFav03QNT6lQK1fjhAAAAAAAAAOUA="},"shape":[100],"dtype":"float64","order":"little"}],["lambda1",{"type":"ndarray","array":{"type":"bytes","data":"TJ+fgW8PfD8Hsyv4G3Z9P2IAelL3+X4/+IwzNzdPgD+OlLVMvDOBP3z+fdHZLII/IpRHgUM9gz/FN8wdKGiEP7FvE7pNsYU/THfuKTYdhz/BVSpyTrGIPyytA0stdIo/ryDYleZtjD/HanlrfKiOP7TVJF09mJA/oNbLqOgKkj/cNCLDhbaTPyCRvdaLqJU/pqev7fjylz+uK9WdYK6aP1ARbf8z/Z0/55Jr85gIoT/APmSXapqjP9cg2QNL7qY/J74Cekpkqz8NFHjx5tKwPyGmms3ke7U/JWOVSH0HvT8Mx2Ts8lrFP1TZLqnMtNE/wtTSJ/AX4D9hXcVndJzrP8W9MVYRyfQ/3SgiPSpJ/D8uMryslgICQNgJc6Da7wVA9qe+kcblCUDkCkxGCOENQHV38Hzl7xBAHTZSXnzwEkB7QZ518fEUQD5P+j4L9BZAQpp6VKL2GECTo4PMmvkaQBtMT0Hg/BxA20mdSGMAH0A0oc3OC4IgQJG3MBP5gyFA1eW5wPGFIkD4BD/3zIcjQBeThLqTiiRAXPkt0oaMJUDaSbH8r44mQGq2pN3nkCdABovqLymTKECSJAHucZUpQNLxROrAlypABy86TxWaK0AUHPl2bpwsQMLHLNrLni1An8BaBy2hLkCOI7OdkaMvQF4a0aT8UjBAQmYv4THUMEDTxgpkaFUxQPB3PhGg1jFARrzZz9hXMkDbWqqJEtkyQO342ypNWjNAdrqnoYjbM0Aq0hDexFw0QKt/q9EB3jRAT49sbz9fNUAC3H+rfeA1QP2hJHu8YTZAEK+O1PviNkC8qcuuO2Q3QN3OqwF85TdAn5+txbxmOECgEuzz/ec4QOrrDoY/aTlATO88doHqOUAMrA+/w2s6QJiriFsG7TpAQtQHR0luO0Bm2UJ9jO87QEqWPfrPcDxABjdDuhPyPEC0FuC5V3M9QBE93PWb9D1ALWk2a+B1PkBkmB8XJfc+QIz89vZpeD9A4FNGCK/5P0B9TF8kej1AQEaAGtscfkBAlx5Qp7++QEDSAAuIYv9AQKpdZHwFQEFAgL+Cg6iAQUA="},"shape":[100],"dtype":"float64","order":"little"}],["lambda2",{"type":"ndarray","array":{"type":"bytes","data":"8jH7+yMGLsAffBC1xAMtwJxSFl9pASzASEcOaxL/KsCCLn1bwPwpwHGR8cdz+ijAnflsYS34J8AZbPX37fUmwKS1rYG28yXA+E33I4jxJMC8BFU/ZO8jwE3uEn9M7SLACuQr7kLrIcDsCpYTSukgwHSKaDLKzh/A1BzIBDDLHcCP0OXzz8cbwNRtFYi3xBnAyWzh0fjBF8DEhNl4rL8VwIS3rwP1vRPAplWdSAS9EcDiB7y3SXoPwFuybKKWfQvAQ4Ndzm+FB8CJ0LAQe5QDwDpq1wSZX/+/IUtSy27E979jk0R4e4vwvyWysRYCc+S/v0aUuQgS17/c7BENZ5jLv3Fbu4bP0cK/0NHeq3NrvL8QOP7V5vK2vwwRKBm4Y7O/rT47Z7PqsL99bzc1Wzuuv3dCXytchKu/Y6/bgzZrqb8yfOj7lMSnvzi0Q3YWdKa/XR58d3lmpb9slsOGUI6kvwSeyqgO4qO/UgAwOdRao78SnVdyrPOiv0ViAeIPqaK/pzvf55J4or+eEJjDsWCiv54QmMOxYKK/pzvf55J4or9FYgHiD6mivxOdV3Ks86K/UAAwOdRao78FnsqoDuKjv2qWw4ZQjqS/Xh58d3lmpb84tEN2FnSmvzZ86PuUxKe/Zq/bgzZrqb98Ql8rXISrv4VvNzVbO66/sT47Z7PqsL8QESgZuGOzvxQ4/tXm8ra/4dHeq3NrvL99W7uGz9HCv/LsEQ1nmMu/20aUuQgS178+srEWAnPkv3GTRHh7i/C/LEtSy27E979NatcEmV//v5LQsBB7lAPAS4Ndzm+FB8Bmsmyiln0LwPQHvLdJeg/ArFWdSAS9EcCKt68D9b0TwMqE2XisvxXAzmzh0fjBF8DabRWIt8QZwJjQ5fPPxxvA2xzIBDDLHcB8imgyys4fwPEKlhNK6SDADeQr7kLrIcBS7hJ/TO0iwMAEVT9k7yPA/E33I4jxJMCqta2BtvMlwB1s9fft9SbAoflsYS34J8B1kfHHc/oowIYufVvA/CnASEcOaxL/KsCcUhZfaQEswB98ELXEAy3A8jH7+yMGLsA="},"shape":[100],"dtype":"float64","order":"little"}],["lambda3",{"type":"ndarray","array":{"type":"bytes","data":"gL+Cg6iAQUCqXWR8BUBBQNIAC4hi/0BAlx5Qp7++QEBIgBrbHH5AQHpMXyR6PUBA2lNGCK/5P0CI/Pb2aXg/QGOYHxcl9z5AK2k2a+B1PkAPPdz1m/Q9QKwW4LlXcz1ABDdDuhPyPEBNlj36z3A8QGzZQn2M7ztAQNQHR0luO0Caq4hbBu06QBCsD7/DazpATu88doHqOUDj6w6GP2k5QJ4S7PP95zhAoZ+txbxmOEDbzqsBfOU3QLypy647ZDdACK+O1PviNkD9oSR7vGE2QALcf6t94DVAT49sbz9fNUCof6vRAd40QCnSEN7EXDRAd7qnoYjbM0Dt+NsqTVozQNtaqokS2TJARbzZz9hXMkDydz4RoNYxQNXGCmRoVTFAQGYv4THUMEBYGtGk/FIwQI4js52Roy9AnsBaBy2hLkC5xyzay54tQBQc+XZunCxA+C46TxWaK0DO8UTqwJcqQJIkAe5xlSlADovqLymTKEBptqTd55AnQMxJsfyvjiZAXPkt0oaMJUAXk4S6k4okQPgEP/fMhyNA1eW5wPGFIkCKtzAT+YMhQDGhzc4LgiBA3kmdSGMAH0AYTE9B4PwcQJKjg8ya+RpAPpp6VKL2GEA8T/o+C/QWQHVBnnXx8RRAGjZSXnzwEkBwd/B85e8QQNkKTEYI4Q1A5qe+kcblCUDSCXOg2u8FQCcyvKyWAgJAzCgiPSpJ/D+4vTFWEcn0P01dxWd0nOs/r9TSJ/AX4D9B2S6pzLTRP/nGZOzyWsU/EWOVSH0HvT8VpprN5Hu1PwYUePHm0rA/Hr4Cekpkqz/MINkDS+6mP7U+ZJdqmqM/35Jr85gIoT9GEW3/M/2dP6Ur1Z1grpo/oKev7fjylz8Wkb3Wi6iVP9U0IsOFtpM/m9bLqOgKkj+x1SRdPZiQP8BqeWt8qI4/qCDYleZtjD8lrQNLLXSKP7xVKnJOsYg/RnfuKTYdhz+sbxO6TbGFP783zB0oaIQ/HpRHgUM9gz95/n3R2SyCP4yUtUy8M4E/+IwzNzdPgD9iAHpS9/l+PwezK/gbdn0/TJ+fgW8PfD8="},"shape":[100],"dtype":"float64","order":"little"}],["triplet1",{"type":"ndarray","array":{"type":"bytes","data":"eQ6S6WSYiz8Ly1KZzm2NP2/jmrJAeo8/JlL+o8rjkD+GKrx6DzGSPwDLyKi9rJM/NZlNf99glT/IjDeKlVqXP5J20W5dq5k/aG5zighrnD8wDAl+2rqfPxBSanNX5aE/VfkZTO1wpD9fWbaSqLenPy978Ch1FKw/O/vLYC8TsT9XLcGxuI21P+kWIpvWt7w/gkTbaQvCxD9krBecON/QP+8wvaKuZ94/lBkJwrxW6j/WwneXDRD0P4ttVeCthvs/maJdZBKfAUCwux20G4sFQHJB2PVMgAlALmSAyBd7DUA8PblNxbwQQA9f2DxAvRJACx4SL6G+FEARvtkqrMAWQJ1gqE04wxhAtthNyijGGkCZFHbEaMkcQP1rGcPozB5ASOuMh05oIECdaytQPmohQN3ezTFAbCJAhB3MXFFuI0CKeK+Nb3AkQCLzBOyYciVA3BWs8ct0JkBxXblXB3cnQMKEbQZKeShAfC0BBZN7KUD6rLVh4X0qQA4bXfUzgCtAj9lPT4iCLEDRgYDwzIQtQOoeVah4hy5AewftZMSJL0B2RTSHE0YwQMVRA6xHxzBANtpdj31IMUAG2oLTtMkxQDMLakbtSjJAFaw9xibMMkDgkwg5YU0zQNxCe4mczjNAsupppdhPNEAq5vt8FdE0QNnnLAJTUjVA7kB4KJHTNUB0Bpzkz1Q2QATsaiwP1jZAdten9k5XN0DwReg6j9g3QKC1e/HPWThA5eNWExHbOECFEAKaUlw5QJaviX+U3TlABBtxvtZeOkAg7qZRGeA6QKjIejRcYTtAT0OUYp/iO0Ce6urX4mM8QA8cv5Am5TxAiKeTiWpmPUApHCi/ruc9QB6rcy7zaD5A8I2g1DfqPkCd4QevfGs/QL7nLbvB7D9A0lFfewM3QED9Y8UvpndAQFd2wvlIuEBAxoJf2Ov4QEBjCbTKjjlBQGkC5c8xekFAlecj59S6QUBn0q0PePtBQHCtykgbPEJAXXbMkb58QkDMjw7qYb1CQPkg9VAF/kJA3oHsxag+Q0Bos2hITH9DQIbh5Nfvv0NALu/ic5MAREA="},"shape":[100],"dtype":"float64","order":"little"}],["triplet2",{"type":"ndarray","array":{"type":"bytes","data":"VSHG6DMJJMC82jnTGgcjwFx0z7EPBSLAtgYE/RQDIcDy4ZHLLQEgwEVHHQ68/h3AaADjbVX7G8Dmot/bNPgZwKxk3dpr9RfABLCpQRLzFcBcHKZZSfETwMwfhwRB8BHAQJQoO4HgD8B+PnI+buMLwKsB+tC06gfAEH37MNH4A8A4R/2eexIAwMA6MFpIg/i/v0dEt7478b+TOYEcAo7lv1E7xGxeU9i/VCf40TeQzL9SG0wbtRPDv8FzQfC1Tby/86D3H6+Btr+FHYD+qr+yv5tO9mHwIrC/AQ5PAm9zrL+Nx/3vpYupv5SRUHBSRae/2dPWNr5ypb8vR0pk+PWjv6YovKScuqK/5jibdlKyob+DX+IQu9Kgv8biwsQqFKC/ITza+rDhnr/KmXYKqcidv/ZPVotX1py/q8zlP08FnL8/hvxLQVGbvxm2NSy8tpq/9wHcTvwymr/VsecaycOZv0GXceZaZ5m/XrnDeUccmb/aGaF4c+GYv9XWS4sHtpi/NRbCeWiZmL92ckGrMYuYv3ZyQasxi5i/NRbCeWiZmL/V1kuLB7aYv9oZoXhz4Zi/YbnDeUccmb9Dl3HmWmeZv9Ox5xrJw5m/+AHcTvwymr8btjUsvLaav0GG/EtBUZu/r8zlP08FnL/8T1aLV9acv8qZdgqpyJ2/Ijza+rDhnr/I4sLEKhSgv4Zf4hC70qC/5zibdlKyob+oKLyknLqivzFHSmT49aO/29PWNr5ypb+WkVBwUkWnv5HH/e+li6m/Bw5PAm9zrL+fTvZh8CKwv4sdgP6qv7K/+qD3H6+Btr/dc0HwtU28v2cbTBu1E8O/dif40TeQzL+DO8RsXlPYv7U5gRwCjuW/1EdEt7478b/YOjBaSIP4v0dH/Z57EgDAH337MNH4A8C/AfrQtOoHwJE+cj5u4wvASJQoO4HgD8DUH4cEQfARwGIcpllJ8RPAC7CpQRLzFcC7ZN3aa/UXwO6i39s0+BnAcgDjbVX7G8BMRx0OvP4dwPfhkcstASDAtgYE/RQDIcBcdM+xDwUiwLzaOdMaByPAVSHG6DMJJMA="},"shape":[100],"dtype":"float64","order":"little"}],["triplet3",{"type":"ndarray","array":{"type":"bytes","data":"Lu/ic5MARECG4eTX779DQGizaEhMf0NA3oHsxag+Q0D6IPVQBf5CQMqPDuphvUJAXnbMkb58QkBwrcpIGzxCQGbSrQ94+0FAkucj59S6QUBsAuXPMXpBQGQJtMqOOUFAxIJf2Ov4QEBRdsL5SLhAQPxjxS+md0BA0lFfewM3QEC95y27wew/QJbhB698az9A9o2g1DfqPkAbq3Mu82g+QCYcKL+u5z1AiaeTiWpmPUANHL+QJuU8QKTq6tfiYzxATEOUYp/iO0ClyHo0XGE7QCbuplEZ4DpAARtxvtZeOkCWr4l/lN05QH8QAppSXDlA4uNWExHbOECftXvxz1k4QO5F6DqP2DdAdNen9k5XN0AJ7GosD9Y2QHUGnOTPVDZA5EB4KJHTNUDY5ywCU1I1QCjm+3wV0TRAsupppdhPNEDcQnuJnM4zQOCTCDlhTTNAFKw9xibMMkAwC2pG7UoyQAbagtO0yTFAMdpdj31IMUDFUQOsR8cwQHZFNIcTRjBAewftZMSJL0DqHlWoeIcuQNGBgPDMhC1Aj9lPT4iCLEAOG131M4ArQPqstWHhfSpAdC0BBZN7KUDBhG0GSnkoQG1duVcHdydA2hWs8ct0JkAg8wTsmHIlQIl4r41vcCRAgR3MXFFuI0DZ3s0xQGwiQJtrK1A+aiFARuuMh05oIED6axnD6MweQI8UdsRoyRxAs9hNyijGGkCZYKhNOMMYQBG+2SqswBZACh4SL6G+FEAPX9g8QL0SQDY9uU3FvBBAJmSAyBd7DUBrQdj1TIAJQKi7HbQbiwVAlKJdZBKfAUBqbVXgrYb7P8HCd5cNEPQ/bBkJwrxW6j+vML2irmfeP0esF5w439A/a0TbaQvCxD/IFiKb1re8P0MtwbG4jbU/LvvLYC8TsT8ee/AodRSsP09ZtpKot6c/TfkZTO1wpD8IUmpzV+WhPycMCX7aup8/X25zighrnD+HdtFuXauZP7yMN4qVWpc/LZlNf99glT/4ysiovayTP4AqvHoPMZI/JlL+o8rjkD9v45qyQHqPPwvLUpnObY0/eQ6S6WSYiz8="},"shape":[100],"dtype":"float64","order":"little"}]]}}},"view":{"type":"object","name":"CDSView","id":"p1119","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1120"}}},"glyph":{"type":"object","name":"Line","id":"p1115","attributes":{"x":{"type":"field","field":"biases"},"y":{"type":"field","field":"lambda1"},"line_color":"blue"}},"nonselection_glyph":{"type":"object","name":"Line","id":"p1116","attributes":{"x":{"type":"field","field":"biases"},"y":{"type":"field","field":"lambda1"},"line_color":"blue","line_alpha":0.1}},"muted_glyph":{"type":"object","name":"Line","id":"p1117","attributes":{"x":{"type":"field","field":"biases"},"y":{"type":"field","field":"lambda1"},"line_color":"blue","line_alpha":0.2}}}},{"type":"object","name":"GlyphRenderer","id":"p1129","attributes":{"data_source":{"id":"p1075"},"view":{"type":"object","name":"CDSView","id":"p1130","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1131"}}},"glyph":{"type":"object","name":"Line","id":"p1126","attributes":{"x":{"type":"field","field":"biases"},"y":{"type":"field","field":"lambda2"},"line_color":"blue"}},"nonselection_glyph":{"type":"object","name":"Line","id":"p1127","attributes":{"x":{"type":"field","field":"biases"},"y":{"type":"field","field":"lambda2"},"line_color":"blue","line_alpha":0.1}},"muted_glyph":{"type":"object","name":"Line","id":"p1128","attributes":{"x":{"type":"field","field":"biases"},"y":{"type":"field","field":"lambda2"},"line_color":"blue","line_alpha":0.2}}}},{"type":"object","name":"GlyphRenderer","id":"p1138","attributes":{"data_source":{"id":"p1075"},"view":{"type":"object","name":"CDSView","id":"p1139","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1140"}}},"glyph":{"type":"object","name":"Line","id":"p1135","attributes":{"x":{"type":"field","field":"biases"},"y":{"type":"field","field":"lambda3"},"line_color":"blue"}},"nonselection_glyph":{"type":"object","name":"Line","id":"p1136","attributes":{"x":{"type":"field","field":"biases"},"y":{"type":"field","field":"lambda3"},"line_color":"blue","line_alpha":0.1}},"muted_glyph":{"type":"object","name":"Line","id":"p1137","attributes":{"x":{"type":"field","field":"biases"},"y":{"type":"field","field":"lambda3"},"line_color":"blue","line_alpha":0.2}}}},{"type":"object","name":"GlyphRenderer","id":"p1147","attributes":{"data_source":{"id":"p1075"},"view":{"type":"object","name":"CDSView","id":"p1148","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1149"}}},"glyph":{"type":"object","name":"Line","id":"p1144","attributes":{"x":{"type":"field","field":"biases"},"y":{"type":"field","field":"triplet1"},"line_color":"red"}},"nonselection_glyph":{"type":"object","name":"Line","id":"p1145","attributes":{"x":{"type":"field","field":"biases"},"y":{"type":"field","field":"triplet1"},"line_color":"red","line_alpha":0.1}},"muted_glyph":{"type":"object","name":"Line","id":"p1146","attributes":{"x":{"type":"field","field":"biases"},"y":{"type":"field","field":"triplet1"},"line_color":"red","line_alpha":0.2}}}},{"type":"object","name":"GlyphRenderer","id":"p1157","attributes":{"data_source":{"id":"p1075"},"view":{"type":"object","name":"CDSView","id":"p1158","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1159"}}},"glyph":{"type":"object","name":"Line","id":"p1154","attributes":{"x":{"type":"field","field":"biases"},"y":{"type":"field","field":"triplet2"},"line_color":"red"}},"nonselection_glyph":{"type":"object","name":"Line","id":"p1155","attributes":{"x":{"type":"field","field":"biases"},"y":{"type":"field","field":"triplet2"},"line_color":"red","line_alpha":0.1}},"muted_glyph":{"type":"object","name":"Line","id":"p1156","attributes":{"x":{"type":"field","field":"biases"},"y":{"type":"field","field":"triplet2"},"line_color":"red","line_alpha":0.2}}}},{"type":"object","name":"GlyphRenderer","id":"p1166","attributes":{"data_source":{"id":"p1075"},"view":{"type":"object","name":"CDSView","id":"p1167","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1168"}}},"glyph":{"type":"object","name":"Line","id":"p1163","attributes":{"x":{"type":"field","field":"biases"},"y":{"type":"field","field":"triplet3"},"line_color":"red"}},"nonselection_glyph":{"type":"object","name":"Line","id":"p1164","attributes":{"x":{"type":"field","field":"biases"},"y":{"type":"field","field":"triplet3"},"line_color":"red","line_alpha":0.1}},"muted_glyph":{"type":"object","name":"Line","id":"p1165","attributes":{"x":{"type":"field","field":"biases"},"y":{"type":"field","field":"triplet3"},"line_color":"red","line_alpha":0.2}}}}],"toolbar":{"type":"object","name":"Toolbar","id":"p1086","attributes":{"tools":[{"type":"object","name":"PanTool","id":"p1101"},{"type":"object","name":"WheelZoomTool","id":"p1102","attributes":{"renderers":"auto"}},{"type":"object","name":"BoxZoomTool","id":"p1103","attributes":{"overlay":{"type":"object","name":"BoxAnnotation","id":"p1104","attributes":{"syncable":false,"level":"overlay","visible":false,"left":{"type":"number","value":"nan"},"right":{"type":"number","value":"nan"},"top":{"type":"number","value":"nan"},"bottom":{"type":"number","value":"nan"},"left_units":"canvas","right_units":"canvas","top_units":"canvas","bottom_units":"canvas","line_color":"black","line_alpha":1.0,"line_width":2,"line_dash":[4,4],"fill_color":"lightgrey","fill_alpha":0.5}}}},{"type":"object","name":"SaveTool","id":"p1109"},{"type":"object","name":"ResetTool","id":"p1110"},{"type":"object","name":"HelpTool","id":"p1111"}]}},"left":[{"type":"object","name":"LinearAxis","id":"p1096","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p1097","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"BasicTickFormatter","id":"p1098"},"axis_label":"$$E\\text{ (energy)}$$","major_label_policy":{"type":"object","name":"AllLabels","id":"p1099"}}}],"below":[{"type":"object","name":"LinearAxis","id":"p1091","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p1092","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"BasicTickFormatter","id":"p1093"},"axis_label":"$$\\text{bias }\\epsilon\\text{ (energy)}$$","major_label_policy":{"type":"object","name":"AllLabels","id":"p1094"}}}],"center":[{"type":"object","name":"Grid","id":"p1095","attributes":{"axis":{"id":"p1091"}}},{"type":"object","name":"Grid","id":"p1100","attributes":{"dimension":1,"axis":{"id":"p1096"}}},{"type":"object","name":"Legend","id":"p1121","attributes":{"items":[{"type":"object","name":"LegendItem","id":"p1122","attributes":{"label":{"type":"value","value":"Singlet"},"renderers":[{"id":"p1118"}]}},{"type":"object","name":"LegendItem","id":"p1150","attributes":{"label":{"type":"value","value":"Triplet"},"renderers":[{"id":"p1147"}]}}]}}]}},{"type":"object","name":"Column","id":"p1172","attributes":{"children":[{"type":"object","name":"Slider","id":"p1169","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"type":"object","name":"CustomJS","id":"p1171","attributes":{"args":{"type":"map","entries":[["source",{"id":"p1075"}],["Uslider",{"id":"p1169"}],["tcslider",{"type":"object","name":"Slider","id":"p1170","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"id":"p1171"}]]]},"title":"$$t_c$$","start":0.05,"end":0.5,"value":0.3,"step":0.01}}],["num",100]]},"code":"\n    const U = Uslider.value;\n    const tc = tcslider.value;\n    const NUM = num;\n    const HALFWAY = Math.floor((NUM - 1) / 2) + 1;\n\n    const biases = source.data.biases;\n    const lambda1 = [];\n    const lambda2 = [];\n    const lambda3 = [];\n\n    var roots = [];\n    for (let i = 0; i &lt; biases.length; i++) {\n        roots = math.polynomialRoot(2 * U * tc * tc, U * U - biases[i] * biases[i] - 2 * tc * tc, -2 * U, 1);\n        roots.sort();\n        lambda2.push(roots[0]);\n        if (i &lt; HALFWAY) {\n            lambda1.push(roots[1]);\n            lambda3.push(roots[2]);\n        } else {\n            lambda3.push(roots[1]);\n            lambda1.push(roots[2]);\n        }\n    }\n\n    source.data = { biases, lambda1, lambda2, lambda3 }\n"}}]]]},"title":"$$U$$","start":1,"end":15.0,"value":10,"step":0.05}},{"id":"p1170"}]}}]}}]}}
    </script>
    <script type="text/javascript">
      (function() {
        const fn = function() {
          Bokeh.safely(function() {
            (function(root) {
              function embed_document(root) {
              const docs_json = document.getElementById('p1181').textContent;
              const render_items = [{"docid":"a57632d7-533c-4e11-8a0b-43dd65afab54","roots":{"p1173":"eb7783a3-531c-477b-a044-2a25681115ea"},"root_ids":["p1173"]}];
              root.Bokeh.embed.embed_items(docs_json, render_items);
              }
              if (root.Bokeh !== undefined) {
                embed_document(root);
              } else {
                let attempts = 0;
                const timer = setInterval(function(root) {
                  if (root.Bokeh !== undefined) {
                    clearInterval(timer);
                    embed_document(root);
                  } else {
                    attempts++;
                    if (attempts > 100) {
                      clearInterval(timer);
                      console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
                    }
                  }
                }, 10, root)
              }
            })(window);
          });
        };
        if (document.readyState != "loading") fn();
        else document.addEventListener("DOMContentLoaded", fn);
      })();
    </script>
  </body>
</html></div></div>
</div>
<p>Note that when <span class="math notranslate nohighlight">\(U&lt;|\epsilon|&lt;U+J\)</span>, the electrons will prefer a (0,2) or (2,0) state if they are in a spin-singlet state, but they will prefer a (1,1) state if they are a spin-triplet. This is the basis for Pauli spin blockade: Set up a source and drain on each side of a double dot containing two electrons in a (1,1) state with unknown spins, with <span class="math notranslate nohighlight">\(\mu_1(0)&lt;\mu_\text{source}&lt;\mu_1(1)\)</span> and <span class="math notranslate nohighlight">\(\mu_2(1)&lt;\mu_\text{drain}&lt;\mu_2(2)\)</span>. Then, the bias is set to be <span class="math notranslate nohighlight">\(-U-J&lt;\epsilon&lt;-J\)</span>. If the electrons are in a spin-singlet state, the electron in dot 1 will be happy to hop to dot 2 and then from there into the drain. Another electron will load into dot 1 from the source and the process can repeat, creating a current. On the other hand, if the electrons are in a triplet state, the (0,2) state is not favorable, so the electron in dot 1 will not move. This creates a “blockade” and prevents current flow. Current is easier to measure than directly measuring spin, so using this phenomenon to determine spin states is very convenient.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./charge-stability/8-spaghetti"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../7-paper-summary/papersummary.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Paper Summaries</p>
      </div>
    </a>
    <a class="right-next"
       href="../roadmap.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Roadmap</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#intro-to-spaghetti-diagrams">Intro to Spaghetti Diagrams</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-new-spin-on-things">A New Spin on Things</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By \'24 HRL Clinic Team
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>